{"filter":false,"title":"Lambda.py","tooltip":"/Lambda.py","undoManager":{"mark":3,"position":3,"stack":[[{"start":{"row":0,"column":0},"end":{"row":41,"column":0},"action":"insert","lines":["import boto3","import requests","import datetime","","BUCKET_NAME = \"landing-casas-mitula\"  # Cambiá esto si usás otro bucket","","headers = {","    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36\"","}","","# Diccionario de medios y sus URLs principales","NEWS_SITES = {","    \"eltiempo\": \"https://www.eltiempo.com/\",","    \"elespectador\": \"https://www.elespectador.com/\"","}","","def download_headlines():","    today = datetime.datetime.now().strftime(\"%Y-%m-%d\")","    s3_client = boto3.client(\"s3\")","","    for site_name, url in NEWS_SITES.items():","        try:","            response = requests.get(url, headers=headers)","            if response.status_code == 200:","                file_name = f\"contenido-{today}.html\"","                temp_file = f\"/tmp/{site_name}-{file_name}\"","                s3_key = f\"headlines/raw/{site_name}-{file_name}\"","                ","                with open(temp_file, \"w\", encoding=\"utf-8\") as file:","                    file.write(response.text)","","                s3_client.upload_file(temp_file, BUCKET_NAME, s3_key)","                print(f\"Subido: s3://{BUCKET_NAME}/{s3_key}\")","            else:","                print(f\"Error descargando {site_name}: {response.status_code}\")","        except Exception as e:","            print(f\"Error con {site_name}: {str(e)}\")","","def lambda_handler(event, context):","    download_headlines()","    return {}",""],"id":1}],[{"start":{"row":4,"column":15},"end":{"row":4,"column":35},"action":"remove","lines":["landing-casas-mitula"],"id":2},{"start":{"row":4,"column":15},"end":{"row":4,"column":16},"action":"insert","lines":["e"]},{"start":{"row":4,"column":16},"end":{"row":4,"column":17},"action":"insert","lines":["l"]},{"start":{"row":4,"column":17},"end":{"row":4,"column":18},"action":"insert","lines":["t"]},{"start":{"row":4,"column":18},"end":{"row":4,"column":19},"action":"insert","lines":["i"]},{"start":{"row":4,"column":19},"end":{"row":4,"column":20},"action":"insert","lines":["e"]},{"start":{"row":4,"column":20},"end":{"row":4,"column":21},"action":"insert","lines":["m"]},{"start":{"row":4,"column":21},"end":{"row":4,"column":22},"action":"insert","lines":["p"]},{"start":{"row":4,"column":22},"end":{"row":4,"column":23},"action":"insert","lines":["o"]},{"start":{"row":4,"column":23},"end":{"row":4,"column":24},"action":"insert","lines":["p"]}],[{"start":{"row":13,"column":21},"end":{"row":13,"column":50},"action":"remove","lines":["https://www.elespectador.com/"],"id":3},{"start":{"row":13,"column":21},"end":{"row":13,"column":47},"action":"insert","lines":["https://www.publimetro.co/"]}],[{"start":{"row":13,"column":5},"end":{"row":13,"column":17},"action":"remove","lines":["elespectador"],"id":4},{"start":{"row":13,"column":5},"end":{"row":13,"column":6},"action":"insert","lines":["p"]},{"start":{"row":13,"column":6},"end":{"row":13,"column":7},"action":"insert","lines":["u"]},{"start":{"row":13,"column":7},"end":{"row":13,"column":8},"action":"insert","lines":["b"]},{"start":{"row":13,"column":8},"end":{"row":13,"column":9},"action":"insert","lines":["l"]},{"start":{"row":13,"column":9},"end":{"row":13,"column":10},"action":"insert","lines":["i"]},{"start":{"row":13,"column":10},"end":{"row":13,"column":11},"action":"insert","lines":["m"]},{"start":{"row":13,"column":11},"end":{"row":13,"column":12},"action":"insert","lines":["e"]},{"start":{"row":13,"column":12},"end":{"row":13,"column":13},"action":"insert","lines":["t"]},{"start":{"row":13,"column":13},"end":{"row":13,"column":14},"action":"insert","lines":["r"]},{"start":{"row":13,"column":14},"end":{"row":13,"column":15},"action":"insert","lines":["o"]}]]},"ace":{"folds":[],"scrolltop":180,"scrollleft":0,"selection":{"start":{"row":26,"column":56},"end":{"row":26,"column":56},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":11,"state":"start","mode":"ace/mode/python"}},"timestamp":1748482445516,"hash":"ba3fc4608c0c5b9bb77a89b2a0f74e8e03600f53"}